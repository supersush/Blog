---
layout: post
title: "AB测试和假设检验"
author: "sush"
header-img: "img/post-bg-web.jpg"
header-mask: 0.4
tags:
  - AB_test
---
### **AB测试，假设检验和概率分布**
对于算法工程师，评估其工作效果最重要的指标就是AB测试的效果，然而工作了很长时间，对于假设检验，显不显著，是什么概率分布等概念还是没有融会贯通。所以写一篇文章把上述概念梳理一下

#### AB测试
A/B测试(也称为分桶测试)为一种随机测试，将两个不同的东西（即A和B）进行假设比较。该测试运用统计学上的假设检定和双母体假设检定。A/B测试可以用来测试某一个变量两个不同版本的差异，一般是让A和B只有该变量不同，再测试其他人对于A和B的反应差异，再判断A和B的方式何者较佳(维基百科)

然而我们首先要面对的问题就是如何确定A组的效果是否好于B组，我们应该使用哪种测试？下表总结了常见的测试，由我们来选择最适合我们问题的测试。
<img src="/blog/img/in-post/ab_test/AB_test.png">

##### 转化率AB测试假设检验Z值计算方法
由于转化过程符合二项分布，所以我们应该采用fisher校验；假设样本数量足够大，我们可以使用广泛采用的Wald方法（参考Lawrence D. Brown, T. Tony Cai, and Anirban DasGupta, “Confidence Intervals for a Binomial Proportion and Asymptotic Expansions,” The Annals of Statistics 30, no. 1 (2002): 160–201.）将该分布近似为正态分布。  
二项分布平均值为p，方差(wald方法)为
<img src="http://latex.codecogs.com/gif.latex? SE_exp^2=\frac{p_experiment(1-p_experiment)}{n_experiment}">
<img src="http://latex.codecogs.com/gif.latex? SE_control^2=\frac{p_control(1-p_control)}{n_control}">
所以符合二项分布的Wald区间的公式  
单侧检验：
<img src="http://latex.codecogs.com/gif.latex? z=(p_experiment-p_control)/\sqrt{SE_exp^2}{SE_conrol^2}">
双侧检验：
<img src="http://latex.codecogs.com/gif.latex? z=|p_experiment-p_control|/\sqrt{SE_exp^2}{SE_conrol^2}">
对于单侧检验，Z值大于1.64则在95%置信区间拒绝该假设（实验组优于对照组）
对于双侧检验，Z值大于1.96则在95%置信区间拒绝该假设 (实验组转化率和对照组不相同)  
置信区间：置信区间表示与真实参数在建议范围内的置信度相关的未知参数的合理值范围。  
<img src="http://latex.codecogs.com/gif.latex? (p_1-p_2)\pm z\sqrt{\frac{p_1(1-p_1)}{n_1}+\frac{p_2(1-p_2)}{n_2}}">
假设真实值为0在此置信区间内，则说明AB无差异；若不在此置信区间内，则证明AB有显著差异



参考文章：
[A/B测试的数学原理和深入理解](https://zhuanlan.zhihu.com/p/34061065)
[为什么要在离线A/B测试中使用贝叶斯方法？](https://mp.weixin.qq.com/s/j1jLa8im9pYXOFdM-6L63w)

